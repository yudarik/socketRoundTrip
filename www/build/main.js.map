{"version":3,"sources":["../../src/providers/socket/socketProvider.ts","../../node_modules/@angular/core/@angular lazy","../../src lazy","../../src/app/app.component.ts","../../src/pages/home/home.ts","../../src/app/main.ts","../../src/app/app.module.ts","../../ws (ignored)","../../src/components/components.module.ts","../../src/components/server-time/server-time.ts"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport 'rxjs/add/operator/map';\nimport { Observable } from 'rxjs/Observable';\nimport * as io from 'socket.io-client';\n\n\n/*\n  Generated class for the AppProvider provider.\n\n  See https://angular.io/guide/dependency-injection for more info on providers\n  and Angular DI.\n*/\n@Injectable()\nexport class SocketProvider {\n\n  private socket;\n\n  private clientRequestTS;\n  private clientResponseTS;\n  private serverRequestTS;\n  private serverResponseTS;\n\n  constructor() {\n    console.log('Hello AppProvider Provider');\n  }\n\n  connect(url) {\n\n    let connectUrl = url.replace(/\\/$/,'');\n    this.socket = io(connectUrl);\n\n    return new Promise((resolve) => {\n      this.socket.on('connect', resolve);\n    });\n  }\n\n  sendMessage(message){\n    this.clientRequestTS = Date.now();\n    this.socket.emit('message', message);\n  }\n\n  getMessages() {\n    let observable = new Observable(observer => {\n\n      this.socket.on('message', (data) => {\n\n        this.clientResponseTS = Date.now();\n\n        this.serverRequestTS = data.serverRequestTS;\n        this.serverResponseTS = data.serverResponseTS;\n\n        observer.next(data);\n      });\n      return () => {\n        this.socket.disconnect();\n      };\n    });\n    return observable;\n  }\n\n  getOffset() {\n    return Math.abs((this.serverRequestTS - this.clientRequestTS) + (this.serverResponseTS - this.clientResponseTS)) / 2;\n  }\n\n  getRoundTripDelay() {\n    return Math.abs(this.clientResponseTS - this.clientRequestTS) - (this.serverResponseTS - this.serverRequestTS);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/providers/socket/socketProvider.ts","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 116;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@angular/core/@angular lazy\n// module id = 116\n// module chunks = 0","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 158;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src lazy\n// module id = 158\n// module chunks = 0","import { Component, Inject } from '@angular/core';\nimport { Platform, LoadingController} from 'ionic-angular';\nimport { StatusBar } from '@ionic-native/status-bar';\nimport { SplashScreen } from '@ionic-native/splash-screen';\n\nimport { HomePage } from '../pages/home/home';\nimport { FormGroup, FormBuilder} from \"@angular/forms\";\nimport {SocketProvider} from \"../providers/socket/socketProvider\";\n\n@Component({\n  templateUrl: 'app.html'\n})\nexport class MyApp {\n  rootPage:any = HomePage;\n  serverAddressForm: FormGroup;\n  connected: boolean;\n  loader: any;\n  error: string;\n\n  constructor(private fb: FormBuilder, private socketProvider: SocketProvider,\n              @Inject(Window) private _window: Window,\n              public loadingCtrl: LoadingController, platform: Platform, statusBar: StatusBar, splashScreen: SplashScreen) {\n    platform.ready().then(() => {\n      // Okay, so the platform is ready and our plugins are available.\n      // Here you can do any higher level native things you might need.\n      statusBar.styleDefault();\n      splashScreen.hide();\n    });\n  }\n\n  ngOnInit() {\n    this.serverAddressForm = this.fb.group({\n      address: `https://socket-round-trip.herokuapp.com`\n    });\n    this.connected = false;\n  }\n\n  presentLoading() {\n    this.error = null;\n    this.loader = this.loadingCtrl.create({\n      content: \"Please wait...\",\n      duration: 30000\n    });\n    this.loader.present();\n\n    setTimeout(() => {\n      this.error = 'Unable to connect to server';\n      this.loader.dismiss();\n    }, 5000);\n  }\n\n  connect2Server() {\n    this.presentLoading();\n\n    this.socketProvider.connect(this.serverAddressForm.get('address').value).then(() => {\n      this.connected = true;\n      this.loader.dismiss();\n    });\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.component.ts","import { Component } from '@angular/core';\nimport { NavController } from 'ionic-angular';\n\n@Component({\n  selector: 'page-home',\n  templateUrl: 'home.html'\n})\nexport class HomePage {\n\n  constructor(public navCtrl: NavController) {\n\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.ts","import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app.module';\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/main.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { ErrorHandler, NgModule } from '@angular/core';\nimport { IonicApp, IonicErrorHandler, IonicModule } from 'ionic-angular';\nimport { SplashScreen } from '@ionic-native/splash-screen';\nimport { StatusBar } from '@ionic-native/status-bar';\n\nimport { MyApp } from './app.component';\nimport { HomePage } from '../pages/home/home';\nimport { SocketProvider } from '../providers/socket/socketProvider';\nimport {ComponentsModule} from \"../components/components.module\";\n\n\n@NgModule({\n  declarations: [\n    MyApp,\n    HomePage\n  ],\n  imports: [\n    ComponentsModule,\n    BrowserModule,\n    IonicModule.forRoot(MyApp)\n  ],\n  bootstrap: [IonicApp],\n  entryComponents: [\n    MyApp,\n    HomePage\n  ],\n  providers: [\n    StatusBar,\n    SplashScreen,\n    {provide: ErrorHandler, useClass: IonicErrorHandler},\n    {provide: Window, useValue: window},\n    SocketProvider\n  ]\n})\nexport class AppModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ts","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// ws (ignored)\n// module id = 303\n// module chunks = 0","import { NgModule } from '@angular/core';\nimport { ServerTimeComponent } from './server-time/server-time';\nimport { IonicApp, IonicModule } from 'ionic-angular';\nimport { MyApp } from '../app/app.component';\n\n\n@NgModule({\n\tdeclarations: [ServerTimeComponent],\n\timports: [IonicModule.forRoot(MyApp)],\n  bootstrap: [IonicApp],\n\texports: [ServerTimeComponent]\n})\nexport class ComponentsModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/components.module.ts","import { Component } from '@angular/core';\nimport { Platform } from 'ionic-angular';\nimport {SocketProvider} from \"../../providers/socket/socketProvider\";\n\n/**\n * Generated class for the ServerTimeComponent component.\n *\n * See https://angular.io/api/core/Component for more info on Angular\n * Components.\n */\n@Component({\n  selector: 'server-time',\n  templateUrl: 'server-time.html'\n})\nexport class ServerTimeComponent {\n\n  connection: any;\n\n  roundTripDelay;\n  timeOffset;\n  timeOutDelay;\n\n  constructor(platform: Platform, private socketProvider: SocketProvider) {\n    platform.ready().then(() => {});\n  }\n\n  ngOnInit() {\n\n    this.connection = this.socketProvider.getMessages().subscribe(message => {\n\n      this.roundTripDelay = this.socketProvider.getRoundTripDelay();\n      this.timeOffset = this.socketProvider.getOffset();\n\n      if (message) {\n        this.timeOutDelay = setTimeout(() => {\n          this.socketProvider.sendMessage({text: 'hello world'})\n        }, 2000);\n      }\n    });\n    this.connection = this.socketProvider.sendMessage({text: 'hello world'});\n  }\n\n  ngOnDestroy() {\n    this.connection.unsubscribe();\n    clearTimeout(this.timeOutDelay);\n  }\n\n  getRotate(val) {\n    return `rotate(${val}deg)`\n  }\n\n  getClientTime() {\n    return new Date();\n  }\n\n  getServerTime() {\n    return new Date(Date.now() - this.timeOffset);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/server-time/server-time.ts"],"sourceRoot":""}